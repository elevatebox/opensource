import requests
from bs4 import BeautifulSoup
import pandas as pd
import json

def fetch_job_listings(url):
    """Fetch job listings from the specified URL."""
    response = requests.get(url)
    
    if response.status_code != 200:
        print("Failed to retrieve the page")
        return []
    
    return response.content

def parse_job_listings(html_content):
    """Parse job listings from HTML content."""
    soup = BeautifulSoup(html_content, 'html.parser')
    job_listings = soup.find_all('div', class_='sMn82b')  # Adjust the class based on actual site structure
    return job_listings

def extract_job_data(job):
    """Extract data from a single job listing."""
    company_name = job.find('span', class_='RP7SMd').text.strip()
    job_title = job.find('h3', class_='QJPWVe').text.strip()
    
    location_elements = job.find_all('span', class_='r0wTof')
    locations = [location.text.strip() for location in location_elements]
    job_location = ", ".join(locations)
    
    qualifications = job.find('div', class_='Xsxa1e').find_all('li')
    job_description = "\n".join([qualification.text.strip() for qualification in qualifications])
    
    return {
        'Company Name': company_name,
        'Job Title': job_title,
        'Job Location': job_location,
        'Job Description': job_description
    }

def main():
    url = "https://www.google.com/about/careers/applications/jobs/results/?location=India"
    html_content = fetch_job_listings(url)
    
    job_listings = parse_job_listings(html_content)
    
    data = []
    max_jobs = 20  # Limit to 20 companies
    
    for job in job_listings[:max_jobs]:  # Limit to first max_jobs
        job_data = extract_job_data(job)
        data.append(job_data)

    # Step 4: Save data to CSV
    df = pd.DataFrame(data)
    df.to_csv('job_listings.csv', index=False)

    # Step 5: Save data to JSON
    with open('job_listings.json', 'w') as json_file:
        json.dump(data, json_file, indent=4)

    # Print the extracted data
    for job in data:
        print(f"Company Name: {job['Company Name']}")
        print(f"Job Title: {job['Job Title']}")
        print("Job Location:", job['Job Location'])
        print("Job Description:")
        print(job['Job Description'])
        print("\n" + "-" * 40 + "\n")

if __name__ == "__main__":
    main()
